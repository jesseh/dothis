from django.core.management.base import BaseCommand

from volunteering.models import Family


class Command(BaseCommand):
    help = 'Load location data into the database idempotently.'

    def handle(self, *args, **options):
        regent = {
            'AB10',
            'AB11',
            'AB20',
            'AB36',
            'AB71',
            'AB73',
            'AB76',
            'AB77',
            'AB78',
            'AB79',
            'AB81',
            'AC44',
            'AD42',
            'AI25',
            'AL22',
            'AL26',
            'AL30',
            'AM40',
            'AN10',
            'AN15',
            'AT80',
            'AU90',
            'AU91',
            'AV01',
            'BA19',
            'BA31',
            'BA33',
            'BA38',
            'BA75',
            'BA76',
            'BE03',
            'BE05',
            'BE06',
            'BE14',
            'BE30',
            'BE45',
            'BE47',
            'BE51',
            'BE52',
            'BE66',
            'BE67',
            'BI10',
            'BI20',
            'BI69',
            'BL08',
            'BL10',
            'BL14',
            'BL18',
            'BL22',
            'BL70',
            'BO30',
            'BO50',
            'BO55',
            'BO89',
            'BO94',
            'BO96',
            'BR01',
            'BR03',
            'BR04',
            'BR38',
            'BR54',
            'BU10',
            'BU15',
            'BU20',
            'BU27',
            'BU40',
            'BU80',
            'BY02',
            'CA17',
            'CA50',
            'CA51',
            'CA52',
            'CA53',
            'CA54',
            'CA67',
            'CA69',
            'CA70',
            'CA79',
            'CA80',
            'CE80',
            'CH03',
            'CH05',
            'CH24',
            'CH30',
            'CI53',
            'CL05',
            'CO10',
            'CO18',
            'CO34',
            'CO35',
            'CO40',
            'CO44',
            'CO46',
            'CO50',
            'CO62',
            'CO70',
            'CO76',
            'CO78',
            'CO80',
            'CO94',
            'CO95',
            'CR12',
            'CU30',
            'CU67',
            'CU68',
            'CU69',
            'DA25',
            'DA87',
            'DA92',
            'DE09',
            'DE16',
            'DE21',
            'DE26',
            'DE60',
            'DE80',
            'DO12',
            'DO15',
            'DO45',
            'DO46',
            'DR40',
            'DU15',
            'ED17',
            'EH69',
            'EI53',
            'EK15',
            'EL10',
            'EM20',
            'EN10',
            'ER46',
            'ES10',
            'ES16',
            'FA15',
            'FA40',
            'FA41',
            'FA42',
            'FA70',
            'FE41',
            'FE43',
            'FE60',
            'FE69',
            'FE72',
            'FI27',
            'FI40',
            'FI55',
            'FI56',
            'FL20',
            'FO90',
            'FO91',
            'FR18',
            'FR23',
            'FU80',
            'GA35',
            'GE15',
            'GE50',
            'GE55',
            'GE69',
            'GI05',
            'GI30',
            'GI42',
            'GL05',
            'GL10',
            'GL16',
            'GL23',
            'GO17',
            'GO26',
            'GO34',
            'GO37',
            'GO40',
            'GO42',
            'GO43',
            'GO49',
            'GO51',
            'GO52',
            'GO54',
            'GO56',
            'GO59',
            'GO62',
            'GO63',
            'GO64',
            'GO76',
            'GO90',
            'GO99',
            'GR02',
            'GR04',
            'GR07',
            'GR10',
            'GR15',
            'GR19',
            'GR22',
            'GR27',
            'GR30',
            'GR44',
            'GR45',
            'GR46',
            'GR55',
            'GR80',
            'GR88',
            'GU50',
            'GU80',
            'HA20',
            'HA22',
            'HA58',
            'HA66',
            'HA80',
            'HE85',
            'HE89',
            'HI01',
            'HI30',
            'HO23',
            'HO30',
            'HO36',
            'HO37',
            'HO38',
            'HO43',
            'HY22',
            'HY53',
            'IN22',
            'IS60',
            'IZ30',
            'IZ31',
            'JA18',
            'JA45',
            'JA48',
            'JA49',
            'JA50',
            'JA58',
            'JA60',
            'JA61',
            'JA71',
            'JA72',
            'JA74',
            'JA80',
            'JA82',
            'JA83',
            'JA84',
            'JO30',
            'JO33',
            'JO70',
            'JO72',
            'JO74',
            'JU15',
            'K155',
            'KA18',
            'KA32',
            'KA33',
            'KA81',
            'KA94',
            'KA95',
            'KA96',
            'KE10',
            'KE19',
            'KE45',
            'KE46',
            'KE48',
            'KL30',
            'KL50',
            'KO20',
            'KR15',
            'KR17',
            'KR20',
            'KR30',
            'KR40',
            'KR60',
            'KR62',
            'KR83',
            'LA25',
            'LA28',
            'LA35',
            'LA58',
            'LA60',
            'LA63',
            'LA94',
            'LE07',
            'LE09',
            'LE12',
            'LE14',
            'LE15',
            'LE19',
            'LE30',
            'LE31',
            'LE32',
            'LE33',
            'LE34',
            'LE50',
            'LE60',
            'LE88',
            'LE93',
            'LO15',
            'MA49',
            'MA62',
            'MA68',
            'MA69',
            'MA84',
            'MA92',
            'MA93',
            'MA94',
            'MC30',
            'MC31',
            'MC32',
            'ME75',
            'MI55',
            'MO13',
            'MO50',
            'MY22',
            'NA16',
            'NA90',
            'NE45',
            'NE90',
            'NE96',
            'NI10',
            'NI51',
            'NY70',
            'OA02',
            'OL49',
            'PE10',
            'PE15',
            'PE22',
            'PO27',
            'PO70',
            'RE04',
            'RE15',
            'RE20',
            'RI03',
            'RO04',
            'RO40',
            'RO79',
            'RO85',
            'RO88',
            'RO89',
            'SA12',
            'SA14',
            'SA15',
            'SA16',
            'SA35',
            'SA38',
            'SA55',
            'SA57',
            'SA60',
            'SA81',
            'SA85',
            'SC18',
            'SE25',
            'SH18',
            'SH22',
            'SH24',
            'SH25',
            'SH32',
            'SH55',
            'SI22',
            'SI51',
            'SI52',
            'SI53',
            'SI72',
            'SL58',
            'SM17',
            'SM19',
            'SO36',
            'SP22',
            'ST16',
            'ST36',
            'ST56',
            'ST58',
            'SU84',
            'SU85',
            'SY30',
            'TA71',
            'TA80',
            'TA82',
            'TA85',
            'TA90',
            'TE75',
            'TO10',
            'TO22',
            'TU25',
            'VA17',
            'VE20',
            'VE30',
            'WA08',
            'WA10',
            'WA13',
            'WA14',
            'WA15',
            'WA20',
            'WA27',
            'WA37',
            'WA40',
            'WA50',
            'WE12',
            'WE22',
            'WE48',
            'WE54',
            'WE55',
            'WE80',
            'WH50',
            'WI36',
            'WI52',
            'WI70',
            'WI80',
            'WI96',
            'WO20',
            'WO48',
            'WO60',
            'WY10',
            'XI47',
            'XI55',
            'XU40',
            'YA05',
            'YA10',
            'ZA33',
            'ZG80',
            'ZS50',
            'ZS65',
            'ZS70',
            'ZS80',
            'ZX15',
        }

        shul = {
            'AA72',
            'AB05',
            'AB19',
            'AB67',
            'AB69',
            'AB75',
            'AB80',
            'AC38',
            'AC50',
            'AD30',
            'AD40',
            'AD42',
            'AD45',
            'AD48',
            'AL05',
            'AL15',
            'AL29',
            'AL32',
            'AL33',
            'AL40',
            'AL43',
            'AL76',
            'AL78',
            'AM15',
            'AS10',
            'BA22',
            'BA45',
            'BA46',
            'BA48',
            'BA50',
            'BA51',
            'BA55',
            'BA60',
            'BA65',
            'BA69',
            'BA84',
            'BA86',
            'BE07',
            'BE10',
            'BE12',
            'BE13',
            'BE15',
            'BE16',
            'BE17',
            'BE18',
            'BE20',
            'BE23',
            'BE24',
            'BE26',
            'BE33',
            'BE35',
            'BE40',
            'BE50',
            'BE53',
            'BE55',
            'BE56',
            'BE58',
            'BE60',
            'BE62',
            'BE68',
            'BE71',
            'BE72',
            'BE74',
            'BE75',
            'BE80',
            'BE85',
            'BE90',
            'BI80',
            'BL02',
            'BL03',
            'BL04',
            'BL05',
            'BL11',
            'BL12',
            'BL15',
            'BL17',
            'BL18',
            'BL50',
            'BL67',
            'BL69',
            'BL72',
            'BL74',
            'BL76',
            'BL77',
            'BL81',
            'BL82',
            'BL84',
            'BL88',
            'BL90',
            'BO22',
            'BO28',
            'BO31',
            'BO65',
            'BO88',
            'BO96',
            'BO98',
            'BR08',
            'BR10',
            'BR15',
            'BR23',
            'BR34',
            'BR50',
            'BR60',
            'BR67',
            'BU60',
            'BU65',
            'CA55',
            'CA59',
            'CA60',
            'CA64',
            'CA66',
            'CA73',
            'CA74',
            'CA85',
            'CA86',
            'CA87',
            'CH08',
            'CH12',
            'CH13',
            'CH14',
            'CH17',
            'CH19',
            'CH20',
            'CH21',
            'CH27',
            'CH40',
            'CH43',
            'CL30',
            'CL36',
            'CO12',
            'CO14',
            'CO20',
            'CO22',
            'CO24',
            'CO25',
            'CO27',
            'CO29',
            'CO31',
            'CO32',
            'CO33',
            'CO36',
            'CO37',
            'CO38',
            'CO39',
            'CO41',
            'CO43',
            'CO45',
            'CO47',
            'CO48',
            'CO49',
            'CO52',
            'CO54',
            'CO55',
            'CO57',
            'CO59',
            'CO65',
            'CO66',
            'CO68',
            'CO71',
            'CO85',
            'CR10',
            'CR14',
            'CR20',
            'CR30',
            'CS05',
            'CU19',
            'CU21',
            'CU22',
            'CU25',
            'CU30',
            'DA35',
            'DA40',
            'DA41',
            'DA52',
            'DA60',
            'DA70',
            'DA76',
            'DA77',
            'DA80',
            'DA81',
            'DA82',
            'DA84',
            'DA85',
            'DA88',
            'DA90',
            'DE11',
            'DE20',
            'DE34',
            'DI04',
            'DI36',
            'DO48',
            'DO50',
            'DO80',
            'DR20',
            'DR25',
            'DR36',
            'DR81',
            'DU20',
            'ED19',
            'ED21',
            'ED22',
            'ED23',
            'ED24',
            'EH72',
            'EH74',
            'EI46',
            'EI47',
            'EI50',
            'EI51',
            'EI52',
            'EL22',
            'EL70',
            'EM10',
            'EN05',
            'EP74',
            'EP75',
            'EP76',
            'ES12',
            'EZ25',
            'FA20',
            'FA73',
            'FA74',
            'FA75',
            'FE04',
            'FE05',
            'FE10',
            'FE15',
            'FE44',
            'FE45',
            'FE46',
            'FE48',
            'FE58',
            'FI20',
            'FI25',
            'FI30',
            'FI43',
            'FI45',
            'FI52',
            'FI54',
            'FI59',
            'FI73',
            'FI80',
            'FO20',
            'FO88',
            'FR10',
            'FR15',
            'FR22',
            'FR25',
            'FR29',
            'FR31',
            'FR51',
            'FU30',
            'FU70',
            'GA05',
            'GA10',
            'GA11',
            'GA23',
            'GA40',
            'GA45',
            'GA70',
            'GA71',
            'GE10',
            'GE92',
            'GH20',
            'GI20',
            'GI21',
            'GL03',
            'GL15',
            'GL20',
            'GO12',
            'GO15',
            'GO19',
            'GO20',
            'GO22',
            'GO24',
            'GO27',
            'GO31',
            'GO41',
            'GO45',
            'GO46',
            'GO47',
            'GO48',
            'GO50',
            'GO60',
            'GO61',
            'GO65',
            'GO70',
            'GO74',
            'GO80',
            'GO81',
            'GO91',
            'GO92',
            'GO97',
            'GO98',
            'GR03',
            'GR06',
            'GR17',
            'GR20',
            'GR32',
            'GR33',
            'GR42',
            'GR60',
            'GR85',
            'GR90',
            'GU75',
            'HA10',
            'HA10`',
            'HA25',
            'HA46',
            'HA49',
            'HA61',
            'HA62',
            'HA70',
            'HA72',
            'HE40',
            'HE80',
            'HE82',
            'HI05',
            'HI10',
            'HI27',
            'HI45',
            'HO12',
            'HO18',
            'HO20',
            'HO25',
            'HO40',
            'HO41',
            'HO60',
            'HO65',
            'HY10',
            'Hi27',
            'IG69',
            'IG72',
            'IG73',
            'IN40',
            'IS01',
            'IS15',
            'IS73',
            'JA20',
            'JA26',
            'JA32',
            'JA40',
            'JA52',
            'JA56',
            'JA59',
            'JA90',
            'JO10',
            'JO20',
            'JO54',
            'JO58',
            'JO60',
            'JO62',
            'JO66',
            'JO67',
            'JO68',
            'JO69',
            'JU50',
            'JU52',
            'KA07',
            'KA12',
            'KA18',
            'KA23',
            'KA25',
            'KA30',
            'KA34',
            'KA40',
            'KA42',
            'KA50',
            'KA63',
            'KA65',
            'KA82',
            'KA90',
            'KA98',
            'KA99',
            'KE22',
            'KE38',
            'KE55',
            'KE60',
            'KE73',
            'KE74',
            'KE80',
            'KI50',
            'KI64',
            'KI70',
            'KL70',
            'KO10',
            'KO30',
            'KO50',
            'KO80',
            'KR50',
            'KR55',
            'KR81',
            'KU10',
            'LA15',
            'LA30',
            'LA40',
            'LA50',
            'LA54',
            'LA55',
            'LA56',
            'LA57',
            'LA62',
            'LA65',
            'LA88',
            'LA90',
            'LE00',
            'LE01',
            'LE22',
            'LE28',
            'LE65',
            'LE69',
            'LE70',
            'LE71',
            'LE72',
            'LE73',
            'LE74',
            'LE75',
            'LE76',
            'LE77',
            'LE78',
            'LE79',
            'LE81',
            'LE82',
            'LE84',
            'LE87',
            'LE89',
            'LE90',
            'LE91',
            'LE94',
            'LE95',
            'LE97',
            'LI05',
            'LI32',
            'LI34',
            'LI60',
            'LO19',
            'LO21',
            'LO30',
            'LO45',
            'LU14',
            'LU17',
            'LU70',
            'LY50',
            'MA15',
            'MA17',
            'MA20',
            'MA35',
            'MA40',
            'MA50',
            'MA51',
            'MA53',
            'MA54',
            'MA60',
            'MA62',
            'MA63',
            'MA65',
            'MA66',
            'MA67',
            'MA80',
            'MA83',
            'MA85',
            'MA90',
            'MC01',
            'MC10',
            'MC15',
            'MC80',
            'ME15',
            'ME20',
            'ME26',
            'ME30',
            'ME35',
            'ME70',
            'ME80',
            'ME85',
            'ME94',
            'ME95',
            'ME96',
            'MI20',
            'MI25',
            'MI28',
            'MI30',
            'MI31',
            'MI35',
            'MI46',
            'MI49',
            'MI54',
            'MI56',
            'MO22',
            'MO26',
            'MO27',
            'MO38',
            'MO40',
            'MO42',
            'MO45',
            'MO55',
            'MO56',
            'MO57',
            'MO59',
            'MO61',
            'MO62',
            'MO63',
            'MO65',
            'MO68',
            'MU70',
            'MY15',
            'NA10',
            'NA12',
            'NA50',
            'NE50',
            'NE80',
            'NE81',
            'NE83',
            'NE85',
            'NE87',
            'NI45',
            'NI50',
            'NY50',
            'OB66',
            'OF50',
            'OK50',
            'OL10',
            'OL74',
            'OP35',
            'OP40',
            'OP45',
            'OR30',
            'OR50',
            'OT10',
            'OW25',
            'PA55',
            'PA60',
            'PA65',
            'PA70',
            'PA75',
            'PE01',
            'PE02',
            'PE04',
            'PE05',
            'PE06',
            'PE12',
            'PE16',
            'PE17',
            'PE26',
            'PE30',
            'PE35',
            'PH30',
            'PH32',
            'PH40',
            'PH42',
            'PI40',
            'PI66',
            'PI90',
            'PL20',
            'PL30',
            'PO40',
            'PO41',
            'PO50',
            'PO60',
            'PO90',
            'PR05',
            'PR10',
            'PR15',
            'PR17',
            'PU50',
            'PU70',
            'PU80',
            'RA14',
            'RA20',
            'RA28',
            'RA35',
            'RA40',
            'RA50',
            'RA55',
            'RE05',
            'RE08',
            'RE09',
            'RE10',
            'RE12',
            'RE25',
            'RE30',
            'RE40',
            'RI05',
            'RI11',
            'RI12',
            'RI13',
            'RI14',
            'RI15',
            'RI30',
            'RI54',
            'RI58',
            'RI60',
            'RI65',
            'RI75',
            'RO01',
            'RO06',
            'RO10',
            'RO15',
            'RO16',
            'RO20',
            'RO22',
            'RO25',
            'RO35',
            'RO44',
            'RO46',
            'RO50',
            'RO60',
            'RO64',
            'RO70',
            'RO71',
            'RO74',
            'RO75',
            'RO76',
            'RO78',
            'RO80',
            'RO81',
            'RO82',
            'RO83',
            'RO84',
            'RO86',
            'RO87',
            'RO90',
            'RO91',
            'RO92',
            'RO94',
            'RO95',
            'RO96',
            'RO98',
            'RU05',
            'RU08',
            'RU12',
            'RU25',
            'RU33',
            'RU41',
            'RU60',
            'RU61',
            'RU62',
            'RU70',
            'RU73',
            'RU75',
            'RU78',
            'RU80',
            'RU82',
            'RU84',
            'SA30',
            'SA32',
            'SA40',
            'SA50',
            'SA52',
            'SA53',
            'SA66',
            'SA70',
            'SC01',
            'SC02',
            'SC12',
            'SC14',
            'SC22',
            'SC24',
            'SC25',
            'SC27',
            'SC30',
            'SC34',
            'SE10',
            'SE20',
            'SE24',
            'SE26',
            'SE27',
            'SE28',
            'SE29',
            'SE32',
            'SE44',
            'SE49',
            'SE54',
            'SH10',
            'SH17',
            'SH26',
            'SH27',
            'SH28',
            'SH30',
            'SH40',
            'SH43',
            'SH50',
            'SH57',
            'SH58',
            'SH60',
            'SH65',
            'SI30',
            'SI32',
            'SI34',
            'SI36',
            'SI38',
            'SI40',
            'SI43',
            'SI44',
            'SI45',
            'SI46',
            'SI47',
            'SI48',
            'SI49',
            'SI50',
            'SI56',
            'SI75',
            'SL04',
            'SL10',
            'SL40',
            'SL41',
            'SL42',
            'SM16',
            'SM20',
            'SM37',
            'SN20',
            'SO20',
            'SO35',
            'SO40',
            'SO42',
            'SO58',
            'SP10',
            'SP23',
            'SP50',
            'SQ08',
            'ST05',
            'ST07',
            'ST09',
            'ST10',
            'ST18',
            'ST19',
            'ST20',
            'ST23',
            'ST24',
            'ST28',
            'ST29',
            'ST30',
            'ST33',
            'ST34',
            'ST38',
            'ST42',
            'ST54',
            'ST89',
            'ST90',
            'ST95',
            'SU30',
            'SU50',
            'SU84',
            'SU95',
            'SU98',
            'SW40',
            'TA30',
            'TA50',
            'TE05',
            'TE10',
            'TE15',
            'TE20',
            'TE21',
            'TI16',
            'TI30',
            'TO18',
            'TO25',
            'TR02',
            'TU29',
            'TU32',
            'TW21',
            'TY40',
            'TZ40',
            'UN04',
            'US30',
            'US35',
            'US40',
            'VA20',
            'VI08',
            'VU10',
            'WA17',
            'WA25',
            'WA30',
            'WA33',
            'WA46',
            'WE10',
            'WE28',
            'WE30',
            'WE31',
            'WE48',
            'WE50',
            'WE73',
            'WH15',
            'WH21',
            'WH35',
            'WH36',
            'WH60',
            'WI20',
            'WI25',
            'WI30',
            'WI40',
            'WI50',
            'WI54',
            'WI87',
            'WI88',
            'WI90',
            'WI94',
            'WO15',
            'WO18',
            'WO46',
            'WO47',
            'WO52',
            'XE25',
            'XE35',
            'XE37',
            'XI40',
            'XI50',
            'XU22',
            'XU24',
            'XU25',
            'XU30',
            'YO30',
            'ZB10',
            'ZD20',
            'ZE20',
            'ZF10',
            'ZG70',
            'ZH30',
            'ZL51',
            'ZM01',
            'ZP10',
            'ZR07',
            'ZS06',
            'ZS15',
            'ZS25',
            'ZS36',
            'ZS40',
            'ZU20',
            'ZX10',
            'ZY30',
        }

        # Reset all hh_locations
        Family.objects.all().update(hh_location=None)

        # And set them
        boths = regent & shul
        regents = regent - boths
        shuls = shul - boths

        counts = {'regent': 0, 'shul': 0, 'both': 0}
        for ex_id in boths:
            counts['both'] += Family.objects.filter(external_id=ex_id
                                                    ).update(hh_location=3)
        for ex_id in regents:
            counts['regent'] += Family.objects.filter(external_id=ex_id
                                                      ).update(hh_location=1)
        for ex_id in shuls:
            counts['shul'] += Family.objects.filter(external_id=ex_id
                                                    ).update(hh_location=2)
        print("Updated: %s" % counts)
