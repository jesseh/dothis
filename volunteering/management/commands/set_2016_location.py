
from django.core.management.base import BaseCommand

from volunteering.models import Family


class Command(BaseCommand):
    help = 'Load location data into the database idempotently.'

    def handle(self, *args, **options):
        regent = {
	'AB36',
	'AB67',
	'AB80',
	'AC38',
	'AD40',
	'AD45',
	'AI25',
	'AL15',
	'AL22',
	'AM15',
	'AS10',
	'AT80',
	'BA45',
	'BA46',
	'BA48',
	'BA50',
	'BA51',
	'BA55',
	'BE07',
	'BE12',
	'BE18',
	'BE27',
	'BE31',
	'BE50',
	'BE53',
	'BE71',
	'BE72',
	'BE74',
	'BE75',
	'BE85',
	'BI20',
	'BL10',
	'BL17',
	'BL27',
	'BL69',
	'BL77',
	'BL90',
	'BO22',
	'BO31',
	'BO50',
	'BO65',
	'BR04',
	'BR10',
	'BR67',
	'BR77',
	'CA27',
	'CA50',
	'CA64',
	'CA66',
	'CH12',
	'CH13',
	'CH14',
	'CH20',
	'CH21',
	'CL36',
	'CO12',
	'CO16',
	'CO20',
	'CO22',
	'CO25',
	'CO29',
	'CO34',
	'CO37',
	'CO40',
	'CO46',
	'CO47',
	'CO59',
	'CO67',
	'CO71',
	'CO78',
	'CO85',
	'CR10',
	'CR14',
	'CR17',
	'CR22',
	'CR30',
	'CU19',
	'CU21',
	'DA41',
	'DA52',
	'DA81',
	'DA84',
	'DE34',
	'DI04',
	'DI36',
	'DO50',
	'DR25',
	'DR81',
	'EH69',
	'EI46',
	'EI47',
	'EI50',
	'EI51',
	'EL70',
	'EN05',
	'EN10',
	'ES12',
	'FA73',
	'FA75',
	'FE04',
	'FE05',
	'FE15',
	'FE45',
	'FE60',
	'FI30',
	'FI59',
	'FO90',
	'FO91',
	'FR10',
	'FR29',
	'GA24',
	'GE22',
	'GE69',
	'GI05',
	'GI20',
	'GI21',
	'GO12',
	'GO17',
	'GO19',
	'GO24',
	'GO27',
	'GO41',
	'GO45',
	'GO47',
	'GO51',
	'GO65',
	'GO74',
	'GO90',
	'GR25',
	'GR60',
	'GR85',
	'GR90',
	'Gold',
	'HA25',
	'HI10',
	'HI45',
	'HO40',
	'HO41',
	'IG73',
	'JA23',
	'JA30',
	'JA45',
	'JA48',
	'JA49',
	'JA56',
	'JA90',
	'JO15',
	'JO17',
	'JO22',
	'JO30',
	'JO58',
	'JO62',
	'JO67',
	'JO68',
	'JO69',
	'KA07',
	'KA82',
	'KA98',
	'KE19',
	'KE22',
	'KE74',
	'KE80',
	'KH02',
	'KL33',
	'KL70',
	'KO80',
	'KR81',
	'LA30',
	'LA33',
	'LA34',
	'LA90',
	'LE01',
	'LE19',
	'LE22',
	'LE24',
	'LE28',
	'LE65',
	'LE70',
	'LE76',
	'LE79',
	'LE81',
	'LE82',
	'LE87',
	'LE88',
	'LE95',
	'LI32',
	'LI60',
	'LO19',
	'LO21',
	'LO30',
	'LU70',
	'MA12',
	'MA13',
	'MA15',
	'MA17',
	'MA20',
	'MA40',
	'MA53',
	'MA62',
	'MA65',
	'MA66',
	'MA83',
	'MA90',
	'MC01',
	'MC10',
	'MC15',
	'MC30',
	'MC31',
	'MC32',
	'MC80',
	'ME15',
	'ME20',
	'ME30',
	'ME35',
	'ME80',
	'ME94',
	'ME96',
	'MI25',
	'MI30',
	'MI31',
	'MI56',
	'MO17',
	'MO19',
	'MO40',
	'MO45',
	'MO55',
	'MO59',
	'MO61',
	'MO65',
	'MO68',
	'MU70',
	'MY15',
	'NA10',
	'NA12',
	'NA90',
	'NE33',
	'NE80',
	'NE81',
	'NE87',
	'NE90',
	'NE96',
	'NI10',
	'NI50',
	'OL10',
	'OR50',
	'OW25',
	'PA50',
	'PA60',
	'PA65',
	'PA75',
	'PE02',
	'PE04',
	'PE05',
	'PE16',
	'PE17',
	'PE26',
	'PE35',
	'PH40',
	'PH42',
	'PI40',
	'PI90',
	'PO17',
	'PO40',
	'PO41',
	'PO50',
	'PR17',
	'PU50',
	'PU70',
	'PU80',
	'RA20',
	'RA22',
	'RA35',
	'RA40',
	'RE05',
	'RE10',
	'RE12',
	'RE20',
	'RE25',
	'RI05',
	'RI54',
	'RO01',
	'RO15',
	'RO20',
	'RO22',
	'RO37',
	'RO44',
	'RO46',
	'RO60',
	'RO70',
	'RO71',
	'RO75',
	'RO80',
	'RO81',
	'RO82',
	'RO83',
	'RO85',
	'RO90',
	'RO92',
	'RO96',
	'RU41',
	'RU80',
	'RU82',
	'RU84',
	'S125',
	'S126',
	'S130',
	'SA14',
	'SA15',
	'SA16',
	'SA32',
	'SA40',
	'SA60',
	'SA85',
	'SC01',
	'SC02',
	'SC12',
	'SC27',
	'SC30',
	'SC34',
	'SE10',
	'SE26',
	'SE27',
	'SE29',
	'SE32',
	'SE49',
	'SE54',
	'SH26',
	'SH27',
	'SH50',
	'SH58',
	'SI36',
	'SI43',
	'SI44',
	'SI46',
	'SI53',
	'SI63',
	'SI75',
	'SL04',
	'SL10',
	'SL40',
	'SL41',
	'SL42',
	'SL58',
	'SM16',
	'SM17',
	'SM20',
	'SM37',
	'SO20',
	'SO36',
	'SO40',
	'SO58',
	'SP10',
	'SP22',
	'SP23',
	'SP50',
	'ST07',
	'ST09',
	'ST12',
	'ST20',
	'ST24',
	'ST28',
	'ST54',
	'ST56',
	'ST58',
	'ST95',
	'SU30',
	'SU50',
	'SW37',
	'SW40',
	'TR02',
	'TU32',
	'TZ40',
	'US35',
	'US40',
	'VU10',
	'WA30',
	'WI20',
	'WI90',
	'WI94',
	'WO15',
	'XE35',
	'XE37',
	'XU24',
	'XU25',
	'ZE20',
	'ZN50',
	'ZR07',
	'ZS06',
	'ZS15',
	'ZS36',
	'ZS40',
	'ZS65',
	'ZU20',
	'ZX10',
	    }

        shul = {
	'AA72',
	'AB05',
	'AB10',
	'AB11',
	'AB20',
	'AB69',
	'AB71',
	'AB73',
	'AB75',
	'AB76',
	'AB77',
	'AB78',
	'AB79',
	'AC44',
	'AC50',
	'AD30',
	'AD42',
	'AD48',
	'AL05',
	'AL26',
	'AL29',
	'AL33',
	'AL40',
	'AL43',
	'AL76',
	'AL78',
	'AM40',
	'AN10',
	'AN15',
	'AU90',
	'AU91',
	'AV01',
	'BA19',
	'BA31',
	'BA33',
	'BA38',
	'BA60',
	'BA65',
	'BA75',
	'BA76',
	'BA84',
	'BA86',
	'BE03',
	'BE05',
	'BE06',
	'BE09',
	'BE10',
	'BE13',
	'BE14',
	'BE15',
	'BE16',
	'BE17',
	'BE20',
	'BE23',
	'BE24',
	'BE26',
	'BE30',
	'BE33',
	'BE35',
	'BE40',
	'BE45',
	'BE47',
	'BE51',
	'BE52',
	'BE55',
	'BE56',
	'BE58',
	'BE60',
	'BE62',
	'BE66',
	'BE68',
	'BE80',
	'BE90',
	'BI10',
	'BI69',
	'BI80',
	'BL02',
	'BL03',
	'BL04',
	'BL05',
	'BL08',
	'BL11',
	'BL12',
	'BL14',
	'BL15',
	'BL18',
	'BL22',
	'BL50',
	'BL67',
	'BL70',
	'BL74',
	'BL76',
	'BL81',
	'BL82',
	'BL84',
	'BL88',
	'BO28',
	'BO30',
	'BO55',
	'BO88',
	'BO89',
	'BO94',
	'BO96',
	'BO98',
	'BR01',
	'BR03',
	'BR07',
	'BR08',
	'BR15',
	'BR23',
	'BR34',
	'BR38',
	'BR50',
	'BR54',
	'BR60',
	'BU10',
	'BU15',
	'BU20',
	'BU22',
	'BU27',
	'BU40',
	'BU60',
	'BU65',
	'BU80',
	'BY02',
	'CA17',
	'CA51',
	'CA52',
	'CA53',
	'CA54',
	'CA55',
	'CA59',
	'CA60',
	'CA67',
	'CA69',
	'CA70',
	'CA73',
	'CA74',
	'CA80',
	'CA85',
	'CE80',
	'CH03',
	'CH17',
	'CH19',
	'CH24',
	'CH27',
	'CH30',
	'CH40',
	'CH43',
	'CI53',
	'CL05',
	'CL30',
	'CO10',
	'CO14',
	'CO18',
	'CO24',
	'CO27',
	'CO31',
	'CO32',
	'CO33',
	'CO35',
	'CO36',
	'CO38',
	'CO39',
	'CO44',
	'CO45',
	'CO48',
	'CO49',
	'CO50',
	'CO52',
	'CO54',
	'CO55',
	'CO57',
	'CO65',
	'CO70',
	'CO76',
	'CO80',
	'CO94',
	'CO95',
	'CR12',
	'CR20',
	'CS05',
	'CU22',
	'CU25',
	'CU30',
	'CU67',
	'CU68',
	'CU69',
	'DA17',
	'DA25',
	'DA35',
	'DA40',
	'DA60',
	'DA70',
	'DA76',
	'DA77',
	'DA80',
	'DA82',
	'DA85',
	'DA87',
	'DA88',
	'DA90',
	'DA92',
	'DE09',
	'DE16',
	'DE20',
	'DE21',
	'DE60',
	'DE80',
	'DO12',
	'DO15',
	'DO17',
	'DO45',
	'DO46',
	'DO48',
	'DO80',
	'DR20',
	'DR36',
	'DR40',
	'DU20',
	'ED15',
	'ED17',
	'ED19',
	'ED21',
	'ED22',
	'ED23',
	'ED24',
	'EH72',
	'EH74',
	'EI33',
	'EI52',
	'EI53',
	'EK15',
	'EL10',
	'EL22',
	'EM10',
	'EM20',
	'EP74',
	'EP75',
	'EP76',
	'ER46',
	'ES10',
	'ES16',
	'EZ25',
	'FA15',
	'FA20',
	'FA40',
	'FA41',
	'FA42',
	'FA70',
	'FE10',
	'FE41',
	'FE43',
	'FE44',
	'FE46',
	'FE48',
	'FE58',
	'FE69',
	'FE72',
	'FI20',
	'FI25',
	'FI27',
	'FI33',
	'FI40',
	'FI43',
	'FI45',
	'FI52',
	'FI54',
	'FI55',
	'FI56',
	'FI73',
	'FI80',
	'FL20',
	'FO20',
	'FO88',
	'FR13',
	'FR15',
	'FR18',
	'FR22',
	'FR23',
	'FR25',
	'FR31',
	'FR51',
	'FU30',
	'FU70',
	'FU80',
	'FU90',
	'GA05',
	'GA10',
	'GA11',
	'GA23',
	'GA35',
	'GA40',
	'GA45',
	'GA70',
	'GA71',
	'GE10',
	'GE15',
	'GE50',
	'GE55',
	'GE92',
	'GH20',
	'GI30',
	'GI42',
	'GL03',
	'GL05',
	'GL10',
	'GL15',
	'GL16',
	'GL20',
	'GL23',
	'GO15',
	'GO20',
	'GO22',
	'GO26',
	'GO31',
	'GO34',
	'GO37',
	'GO40',
	'GO42',
	'GO43',
	'GO46',
	'GO48',
	'GO49',
	'GO50',
	'GO51',
	'GO52',
	'GO54',
	'GO56',
	'GO59',
	'GO60',
	'GO61',
	'GO62',
	'GO63',
	'GO64',
	'GO70',
	'GO76',
	'GO80',
	'GO81',
	'GO91',
	'GO92',
	'GO97',
	'GO98',
	'GO99',
	'GR02',
	'GR03',
	'GR04',
	'GR06',
	'GR10',
	'GR15',
	'GR17',
	'GR19',
	'GR20',
	'GR22',
	'GR27',
	'GR30',
	'GR32',
	'GR40',
	'GR42',
	'GR44',
	'GR45',
	'GR46',
	'GR55',
	'GR80',
	'GR88',
	'GU50',
	'GU75',
	'GU80',
	'HA10',
	'HA10',
	'HA19',
	'HA20',
	'HA22',
	'HA40',
	'HA46',
	'HA49',
	'HA58',
	'HA61',
	'HA62',
	'HA66',
	'HA70',
	'HA72',
	'HA80',
	'HE35',
	'HE40',
	'HE80',
	'HE82',
	'HE85',
	'HE89',
	'HI01',
	'HI05',
	'HI27',
	'HI29',
	'HI30',
	'HO12',
	'HO18',
	'HO20',
	'HO23',
	'HO25',
	'HO30',
	'HO36',
	'HO37',
	'HO38',
	'HO43',
	'HO60',
	'HO65',
	'HY10',
	'HY22',
	'HY53',
	'Hi27',
	'IG55',
	'IG69',
	'IG72',
	'IG73',
	'IN22',
	'IS01',
	'IS15',
	'IS60',
	'IS73',
	'IZ30',
	'IZ31',
	'JA18',
	'JA20',
	'JA26',
	'JA32',
	'JA40',
	'JA50',
	'JA52',
	'JA58',
	'JA59',
	'JA60',
	'JA61',
	'JA71',
	'JA72',
	'JA74',
	'JA80',
	'JA82',
	'JA83',
	'JA84',
	'JO10',
	'JO20',
	'JO33',
	'JO54',
	'JO60',
	'JO66',
	'JO70',
	'JO72',
	'JO74',
	'JU15',
	'JU50',
	'JU52',
	'K155',
	'KA12',
	'KA16',
	'KA18',
	'KA23',
	'KA25',
	'KA30',
	'KA32',
	'KA33',
	'KA34',
	'KA40',
	'KA42',
	'KA50',
	'KA63',
	'KA65',
	'KA81',
	'KA90',
	'KA94',
	'KA95',
	'KA96',
	'KA99',
	'KE10',
	'KE38',
	'KE45',
	'KE46',
	'KE48',
	'KE55',
	'KE60',
	'KE73',
	'KI50',
	'KI55',
	'KI64',
	'KI70',
	'KL30',
	'KL50',
	'KO10',
	'KO20',
	'KO30',
	'KO50',
	'KR15',
	'KR17',
	'KR20',
	'KR30',
	'KR40',
	'KR50',
	'KR55',
	'KR60',
	'KR62',
	'KR83',
	'KU10',
	'LA15',
	'LA25',
	'LA28',
	'LA35',
	'LA40',
	'LA50',
	'LA54',
	'LA55',
	'LA56',
	'LA57',
	'LA58',
	'LA60',
	'LA62',
	'LA63',
	'LA65',
	'LA88',
	'LA94',
	'LE00',
	'LE07',
	'LE12',
	'LE14',
	'LE15',
	'LE30',
	'LE31',
	'LE32',
	'LE33',
	'LE34',
	'LE50',
	'LE60',
	'LE69',
	'LE71',
	'LE72',
	'LE73',
	'LE74',
	'LE75',
	'LE77',
	'LE78',
	'LE84',
	'LE90',
	'LE91',
	'LE93',
	'LE94',
	'LE97',
	'LI05',
	'LI34',
	'LU14',
	'LU17',
	'LY50',
	'MA35',
	'MA49',
	'MA50',
	'MA51',
	'MA54',
	'MA60',
	'MA67',
	'MA68',
	'MA69',
	'MA80',
	'MA84',
	'MA92',
	'MA93',
	'MA94',
	'ME26',
	'ME70',
	'ME75',
	'ME85',
	'ME95',
	'MI20',
	'MI28',
	'MI35',
	'MI46',
	'MI49',
	'MI54',
	'MI55',
	'MO13',
	'MO22',
	'MO26',
	'MO27',
	'MO38',
	'MO42',
	'MO50',
	'MO56',
	'MO57',
	'MO62',
	'MO63',
	'MY22',
	'NA16',
	'NA50',
	'NE45',
	'NE50',
	'NE83',
	'NE85',
	'NI45',
	'NI51',
	'NO17',
	'NO22',
	'NY50',
	'NY70',
	'OA02',
	'OB66',
	'OF50',
	'OK50',
	'OL22',
	'OL49',
	'OL74',
	'OP35',
	'OP40',
	'OP45',
	'OR30',
	'OT10',
	'P027',
	'PA70',
	'PE01',
	'PE06',
	'PE10',
	'PE12',
	'PE15',
	'PE22',
	'PE30',
	'PH30',
	'PH32',
	'PI66',
	'PL20',
	'PL30',
	'PO27',
	'PO13',
	'PO27',
	'PO60',
	'PO70',
	'PO90',
	'PR05',
	'PR10',
	'PR15',
	'RA14',
	'RA28',
	'RA50',
	'RA55',
	'RE04',
	'RE09',
	'RE15',
	'RE22',
	'RE30',
	'RE40',
	'RI03',
	'RI11',
	'RI12',
	'RI13',
	'RI14',
	'RI15',
	'RI30',
	'RI58',
	'RI65',
	'RI75',
	'RO04',
	'RO06',
	'RO10',
	'RO12',
	'RO16',
	'RO25',
	'RO35',
	'RO40',
	'RO50',
	'RO60',
	'RO74',
	'RO76',
	'RO78',
	'RO79',
	'RO84',
	'RO86',
	'RO88',
	'RO89',
	'RO91',
	'RO94',
	'RO98',
	'RU05',
	'RU08',
	'RU33',
	'RU60',
	'RU61',
	'RU62',
	'RU70',
	'RU73',
	'RU75',
	'RU78',
	'SA12',
	'SA30',
	'SA35',
	'SA38',
	'SA50',
	'SA52',
	'SA53',
	'SA55',
	'SA57',
	'SA70',
	'SA81',
	'SC14',
	'SC16',
	'SC18',
	'SC22',
	'SC24',
	'SC25',
	'SE10',
	'SE24',
	'SE25',
	'SE26',
	'SE28',
	'SE44',
	'SH10',
	'SH17',
	'SH18',
	'SH22',
	'SH24',
	'SH25',
	'SH28',
	'SH30',
	'SH32',
	'SH40',
	'SH43',
	'SH55',
	'SH57',
	'SH58',
	'SH60',
	'SH65',
	'SI22',
	'SI32',
	'SI34',
	'SI38',
	'SI45',
	'SI47',
	'SI48',
	'SI49',
	'SI50',
	'SI51',
	'SI52',
	'SI56',
	'SI72',
	'SI75',
	'SM19',
	'SM20',
	'SN20',
	'SO35',
	'SP10',
	'SQ08',
	'ST05',
	'ST10',
	'ST16',
	'ST18',
	'ST19',
	'ST23',
	'ST30',
	'ST33',
	'ST34',
	'ST36',
	'ST38',
	'ST42',
	'ST89',
	'ST90',
	'SU40',
	'SU84',
	'SU85',
	'SU95',
	'SU98',
	'SY30',
	'TA22',
	'TA30',
	'TA50',
	'TA80',
	'TA82',
	'TA85',
	'TA90',
	'TE05',
	'TE10',
	'TE15',
	'TE20',
	'TE21',
	'TE75',
	'TI16',
	'TI30',
	'TO10',
	'TO18',
	'TO22',
	'TO25',
	'TO29',
	'TU25',
	'TU29',
	'TW21',
	'TY40',
	'UN04',
	'US30',
	'US40',
	'VA17',
	'VA20',
	'VE25',
	'VE30',
	'VI08',
	'WA08',
	'WA10',
	'WA13',
	'WA15',
	'WA17',
	'WA20',
	'WA25',
	'WA27',
	'WA30',
	'WA33',
	'WA37',
	'WA40',
	'WA46',
	'WA50',
	'WE10',
	'WE12',
	'WE22',
	'WE28',
	'WE30',
	'WE31',
	'WE48',
	'WE50',
	'WE54',
	'WE55',
	'WE73',
	'WE80',
	'WH15',
	'WH35',
	'WH36',
	'WH50',
	'WH60',
	'WI30',
	'WI36',
	'WI40',
	'WI50',
	'WI52',
	'WI54',
	'WI70',
	'WI80',
	'WI87',
	'WI88',
	'WI96',
	'WO18',
	'WO20',
	'WO46',
	'WO47',
	'WO48',
	'WO52',
	'WO60',
	'XE25',
	'XI40',
	'XI47',
	'XI50',
	'XI55',
	'XU22',
	'XU30',
	'XU40',
	'YA05',
	'YA10',
	'YA30',
	'YO30',
	'ZA33',
	'ZB10',
	'ZD20',
	'ZF10',
	'ZG70',
	'ZG80',
	'ZH30',
	'ZL51',
	'ZM01',
	'ZP10',
	'ZS15',
	'ZS25',
	'ZS40',
	'ZS50',
	'ZS60',
	'ZS70',
	'ZS80',
	'ZX10',
	'ZX15',
    }

        # Reset all hh_locations
        Family.objects.all().update(hh_location=None)

        # And set them
        boths = regent & shul
        regents = regent - boths
        shuls = shul - boths

        counts = {'regent': 0, 'shul': 0, 'both': 0}
        for ex_id in boths:
            counts['both'] += Family.objects.filter(external_id=ex_id
                                                    ).update(hh_location=3)
        for ex_id in regents:
            counts['regent'] += Family.objects.filter(external_id=ex_id
                                                      ).update(hh_location=1)
        for ex_id in shuls:
            counts['shul'] += Family.objects.filter(external_id=ex_id
                                                    ).update(hh_location=2)
        print("Updated: %s" % counts)
